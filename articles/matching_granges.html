<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case study I: CTCF enrichment • nullranges</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case study I: CTCF enrichment">
<meta property="og:description" content="nullranges">
<meta property="og:image" content="https://nullranges.github.io/nullranges/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nullranges</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Introduction to nullranges</a>
    </li>
    <li>
      <a href="../articles/matching_ranges.html">Overview of matchRanges</a>
    </li>
    <li>
      <a href="../articles/matching_granges.html">Case study I: CTCF enrichment</a>
    </li>
    <li>
      <a href="../articles/matching_ginteractions.html">Case study II: CTCF orientation</a>
    </li>
    <li>
      <a href="../articles/segmented_boot_ranges.html">Segmented block bootstrap</a>
    </li>
    <li>
      <a href="../articles/unseg_boot_ranges.html">Un-segmented block bootstrap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nullranges/nullranges/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="matching_granges_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case study I: CTCF enrichment</h1>
                        <h4 class="author">Eric S. Davis</h4>
            
            <h4 class="date">06/23/2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nullranges/nullranges/blob/master/vignettes/matching_granges.Rmd"><code>vignettes/matching_granges.Rmd</code></a></small>
      <div class="hidden name"><code>matching_granges.Rmd</code></div>

    </div>

    
    
<p>In this vignette we demonstrate generating covariate-matched, null-hypothesis GRanges using the <code><a href="../reference/matchRanges.html">matchRanges()</a></code> function to test for the enrichment of CCCTC-binding factor (CTCF) at chromatin loop anchors.</p>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>One of the fundamental principles of chromatin-looping suggests that most loops are bound at both ends by the CTCF transcription factor (TF). CTCF-bound loops can be formed by loop-extrusion, where the ring-like cohesin complex extrudes chromatin until stopped by bound CTCF. By this mechanism, we expect most loop anchors will be bound by CTCF.</p>
<p>While we could test this hypothesis by simple overlap or permutation testing, these approaches fail to account for non-randomly distributed covariate genomic features. For example, loop anchors are commonly bound by CTCF and located in open chromatin regions. We can use <code><a href="../reference/matchRanges.html">matchRanges()</a></code> to test for CTCF enrichment at loop anchors independently from open chromatin regions.</p>
<p>Here, we generate a set of null-hypothesis GRanges to more rigorously test CTCF enrichment at loop anchors independently from open chromatin regions. We use the <code>hg19_10kb_bins</code> dataset from the <code>nullrangesData</code> package, which contains ranges for every 10Kb bin along the genome with CTCF, DNase, and loop feature annotations from GM12878 (see <code><a href="https://rdrr.io/pkg/nullrangesData/man/hg19_10kb_bins.html">?nullrangesData::hg19_10kb_bins</a></code>).</p>
<p><img src="matching_granges_files/figure-html/unnamed-chunk-1-1.png"><!-- --></p>
</div>
<div id="matching-with-matchranges" class="section level2">
<h2 class="hasAnchor">
<a href="#matching-with-matchranges" class="anchor"></a>Matching with <code>matchRanges()</code>
</h2>
<p>Before we generate our null ranges, let’s take a look at our example dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nullrangesData</span><span class="op">)</span>

<span class="co">## Load example data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hg19_10kb_bins"</span><span class="op">)</span>
<span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">hg19_10kb_bins</span>

<span class="va">bins</span></code></pre></div>
<pre><code>## GRanges object with 303641 ranges and 5 metadata columns:
##            seqnames              ranges strand | n_ctcf_sites ctcfSignal
##               &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;numeric&gt;  &lt;numeric&gt;
##        [1]     chr1             1-10000      * |            0          0
##        [2]     chr1         10001-20000      * |            0          0
##        [3]     chr1         20001-30000      * |            0          0
##        [4]     chr1         30001-40000      * |            0          0
##        [5]     chr1         40001-50000      * |            0          0
##        ...      ...                 ...    ... .          ...        ...
##   [303637]     chrX 155230001-155240000      * |            0    0.00000
##   [303638]     chrX 155240001-155250000      * |            0    0.00000
##   [303639]     chrX 155250001-155260000      * |            1    4.09522
##   [303640]     chrX 155260001-155270000      * |            0    0.00000
##   [303641]     chrX 155270001-155270560      * |            0    0.00000
##            n_dnase_sites dnaseSignal    looped
##                 &lt;factor&gt;   &lt;numeric&gt; &lt;logical&gt;
##        [1]             0     0.00000     FALSE
##        [2]             0     5.03572     FALSE
##        [3]             0     0.00000     FALSE
##        [4]             0     0.00000     FALSE
##        [5]             0     0.00000     FALSE
##        ...           ...         ...       ...
##   [303637]             0     8.42068     FALSE
##   [303638]             0     4.08961     FALSE
##   [303639]             0     6.00443     FALSE
##   [303640]             0     8.07179     FALSE
##   [303641]             0     0.00000     FALSE
##   -------
##   seqinfo: 23 sequences from hg19 genome</code></pre>
<p><code><a href="../reference/matchRanges.html">matchRanges()</a></code> works by selecting a set of covariate-matched controls from a pool of options based on an input focal set of interest. Here, we define <code>focal</code> as bins that contain a loop anchor, <code>pool</code> as bins that don’t contain a loop anchor, and <code>covar</code> as DNase signal and number of DNase sites per bin:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nullranges/nullranges">nullranges</a></span><span class="op">)</span>

<span class="co">## Match ranges</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">mgr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matchRanges.html">matchRanges</a></span><span class="op">(</span>focal <span class="op">=</span> <span class="va">bins</span><span class="op">[</span><span class="va">bins</span><span class="op">$</span><span class="va">looped</span><span class="op">]</span>,
                   pool <span class="op">=</span> <span class="va">bins</span><span class="op">[</span><span class="op">!</span><span class="va">bins</span><span class="op">$</span><span class="va">looped</span><span class="op">]</span>,
                   covar <span class="op">=</span> <span class="op">~</span><span class="va">dnaseSignal</span> <span class="op">+</span> <span class="va">n_dnase_sites</span><span class="op">)</span>
<span class="va">mgr</span></code></pre></div>
<pre><code>## MatchedGRanges object with 13979 ranges and 5 metadata columns:
##           seqnames              ranges strand | n_ctcf_sites ctcfSignal
##              &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; |    &lt;numeric&gt;  &lt;numeric&gt;
##       [1]     chr8   16360001-16370000      * |            0    0.00000
##       [2]     chr1 212260001-212270000      * |            0    0.00000
##       [3]     chrX     9570001-9580000      * |            0    0.00000
##       [4]     chr9   96840001-96850000      * |            0    0.00000
##       [5]    chr16   31480001-31490000      * |            1    4.82341
##       ...      ...                 ...    ... .          ...        ...
##   [13975]    chr12 105060001-105070000      * |            1    4.29979
##   [13976]     chr4 103530001-103540000      * |            1    5.67681
##   [13977]    chr14   65860001-65870000      * |            0    0.00000
##   [13978]     chr2   96940001-96950000      * |            0    0.00000
##   [13979]    chr19   38910001-38920000      * |            0    0.00000
##           n_dnase_sites dnaseSignal    looped
##                &lt;factor&gt;   &lt;numeric&gt; &lt;logical&gt;
##       [1]            0      7.40552     FALSE
##       [2]            1      9.72456     FALSE
##       [3]            3+    10.87185     FALSE
##       [4]            1      8.86143     FALSE
##       [5]            3+    10.65095     FALSE
##       ...           ...         ...       ...
##   [13975]            3+    13.90788     FALSE
##   [13976]            1      9.89450     FALSE
##   [13977]            1      9.83681     FALSE
##   [13978]            0      9.66206     FALSE
##   [13979]            2     12.13214     FALSE
##   -------
##   seqinfo: 23 sequences from hg19 genome</code></pre>
<p>When the focal and pool arguments are <code>GRanges</code> objects, <code><a href="../reference/matchRanges.html">matchRanges()</a></code> returns a <code>MatchedGRanges</code> object. The <code>MatchedGRanges</code> class extends <code>GRanges</code>, so all of the same operations can be applied:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges">GenomicRanges</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plyranges</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co">## Summarize ctcfSignal by n_ctcf_sites</span>
<span class="va">mgr</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">group_by</a></span><span class="op">(</span><span class="va">n_ctcf_sites</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html">summarize</a></span><span class="op">(</span>ctcfSignal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ctcfSignal</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_ctcf_sites</span>, y <span class="op">=</span> <span class="va">ctcfSignal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, stroke <span class="op">=</span> <span class="fl">1</span>,  fill <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>,
                                      fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="matching_granges_files/figure-html/unnamed-chunk-4-1.png"><!-- --></p>
</div>
<div id="assessing-quality-of-matching" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-quality-of-matching" class="anchor"></a>Assessing quality of matching</h2>
<p>We can get a quick summary of the matching quality with <code><a href="../reference/overview.html">overview()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/overview.html">overview</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span></code></pre></div>
<pre><code>## MatchedGRanges object: 
##        set      N dnaseSignal.mean dnaseSignal.sd n_dnase_sites.0
##      focal  13979             10.0            1.9            2341
##    matched  13979             10.0            1.9            2297
##       pool 289662              7.9            2.7          222164
##  unmatched 275683              7.8            2.7          219867
##  n_dnase_sites.1 n_dnase_sites.2 n_dnase_sites.3+ ps.mean ps.sd
##             4829            2353             4456   0.130 0.072
##             5187            2487             4008   0.130 0.071
##            34826           13627            19045   0.042 0.061
##            29639           11140            15037   0.037 0.057
## --------
## focal - matched: 
##  dnaseSignal.mean dnaseSignal.sd n_dnase_sites.0 n_dnase_sites.1
##             0.037        -0.0061              44            -360
##  n_dnase_sites.2 n_dnase_sites.3+ ps.mean   ps.sd
##             -130              450 0.00025 0.00081</code></pre>
<p>For continuous covariates (such as <code>dnaseSignal</code>), <code><a href="../reference/overview.html">overview()</a></code> shows the mean and standard deviation between each matched set. For categorical covariates, such as <code>n_dnase_sites</code>, <code><a href="../reference/overview.html">overview()</a></code> reports the number of observations per category and matched set. The bottom section shows the mean and s.d (or n, for factors) difference between focal and matched sets.</p>
<p><code><a href="../reference/overview.html">overview()</a></code> also summarizes the propensity scores for each set to give a quick idea of overall matching quality.</p>
<div id="visualizing-matching-results" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-matching-results" class="anchor"></a>Visualizing matching results</h3>
<p>Let’s visualize overall matching quality by plotting propensity scores for the focal, pool, and matched sets:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotPropensity.html">plotPropensity</a></span><span class="op">(</span><span class="va">mgr</span>, sets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'f'</span>, <span class="st">'p'</span>, <span class="st">'m'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'ridges'</span><span class="op">)</span></code></pre></div>
<p><img src="matching_granges_files/figure-html/unnamed-chunk-6-1.png"><!-- --></p>
<p>From this plot, it is clear that the matched set is much closer to the focal set than the pool set.</p>
<p>We can ensure that covariate distributions have been matched appropriately by using the <code><a href="../reference/covariates.html">covariates()</a></code> function to extract matched covariates along with <code>patchwork</code> and <code>plotCovarite</code> to visualize all distributions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/covariates.html">covariates</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span>, <span class="va">plotCovariate</span>, x<span class="op">=</span><span class="va">mgr</span>, sets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'f'</span>, <span class="st">'m'</span>, <span class="st">'p'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="st">'/'</span>, <span class="va">plots</span><span class="op">)</span></code></pre></div>
<p><img src="matching_granges_files/figure-html/unnamed-chunk-7-1.png"><!-- --></p>
</div>
</div>
<div id="compare-ctcf-sites" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-ctcf-sites" class="anchor"></a>Compare CTCF sites</h2>
<p>Using our matched ranges, we can compare enrichment of CTCF between bins that 1) contain a loop anchor (i.e. looped), 2) don’t contain a loop anchor (i.e. unlooped), or 3) don’t contain a loop anchor, but are also matched for the strength and number of DNase sites (i.e. matched). In this case, we calculate CTCF enrichment as the percent of bins that contain CTCF among our 3 sets by using the <code><a href="../reference/focal.html">focal()</a></code> and <code><a href="../reference/pool.html">pool()</a></code> accessor functions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Percent of bins with CTCF</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/focal.html">focal</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span><span class="op">$</span><span class="va">n_ctcf_sites</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/focal.html">focal</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/pool.html">pool</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span><span class="op">$</span><span class="va">n_ctcf_sites</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/pool.html">pool</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">$</span><span class="va">n_ctcf_sites</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mgr</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>

<span class="co">## Visualize</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span><span class="op">)</span>,
        names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'looped\n(focal)'</span>, <span class="st">'unlooped\n(pool)'</span>, <span class="st">'unlooped\n(matched)'</span><span class="op">)</span>,
        ylab <span class="op">=</span> <span class="st">"CTCF occupied bins (%)"</span>,
        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'#1F78B4'</span>, <span class="st">'#33A02C'</span>, <span class="st">'#A6CEE3'</span><span class="op">)</span>,
        main <span class="op">=</span> <span class="st">'CTCF enrichment'</span>,
        border <span class="op">=</span> <span class="cn">NA</span>,
        las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="matching_granges_files/figure-html/unnamed-chunk-8-1.png"><!-- --></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://mikelove.github.io">Michael Love</a>, <a href="https://twitter.com/wancenm">Wancen Mu</a>, <a href="https://ericscottdavis.com">Eric Davis</a>, <a href="http://phanstiel-lab.med.unc.edu">Douglas Phanstiel</a>, <a href="https://stuartlee.org">Stuart Lee</a>, <a href="https://chanzuckerberg.com">CZI</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
